<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.gd.data.mapper.TPosSaleMasterMapper" >
  <resultMap id="BaseResultMap" type="com.gd.data.entity.TPosSaleMaster" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="sheet_no" property="sheetNo" jdbcType="VARCHAR" />
    <result column="oper_date" property="operDate" jdbcType="TIMESTAMP" />
    <result column="sale_time" property="saleTime" jdbcType="TIMESTAMP" />
    <result column="pos_type" property="posType" jdbcType="CHAR" />
    <result column="pos_status" property="posStatus" jdbcType="CHAR" />
    <result column="deal_no" property="dealNo" jdbcType="VARCHAR" />
    <result column="deal_class" property="dealClass" jdbcType="CHAR" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="branch_no" property="branchNo" jdbcType="VARCHAR" />
    <result column="counter_no" property="counterNo" jdbcType="VARCHAR" />
    <result column="jh" property="jh" jdbcType="VARCHAR" />
    <result column="local_no" property="localNo" jdbcType="VARCHAR" />
    <result column="work_no" property="workNo" jdbcType="VARCHAR" />
    <result column="voucher_no" property="voucherNo" jdbcType="VARCHAR" />
    <result column="vip_no" property="vipNo" jdbcType="VARCHAR" />
    <result column="pos_org_amt" property="posOrgAmt" jdbcType="DECIMAL" />
    <result column="pos_total_amt" property="posTotalAmt" jdbcType="DECIMAL" />
    <result column="pos_integral" property="posIntegral" jdbcType="DECIMAL" />
    <result column="cust_name" property="custName" jdbcType="VARCHAR" />
    <result column="cust_man" property="custMan" jdbcType="VARCHAR" />
    <result column="cust_address" property="custAddress" jdbcType="VARCHAR" />
    <result column="cust_tel" property="custTel" jdbcType="VARCHAR" />
    <result column="cust_request" property="custRequest" jdbcType="VARCHAR" />
    <result column="pos_order_time" property="posOrderTime" jdbcType="TIMESTAMP" />
    <result column="pos_send_time" property="posSendTime" jdbcType="TIMESTAMP" />
    <result column="deal_order" property="dealOrder" jdbcType="VARCHAR" />
    <result column="pos_memo" property="posMemo" jdbcType="VARCHAR" />
    <result column="pos_bytxt1" property="posBytxt1" jdbcType="VARCHAR" />
    <result column="pos_bytxt2" property="posBytxt2" jdbcType="VARCHAR" />
    <result column="pos_bytxt3" property="posBytxt3" jdbcType="VARCHAR" />
    <result column="update_flow" property="updateFlow" jdbcType="DECIMAL" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="update_branch" property="updateBranch" jdbcType="VARCHAR" />
    <result column="trans_upflag" property="transUpflag" jdbcType="VARCHAR" />
    <result column="fu_times" property="fuTimes" jdbcType="INTEGER" />
    <result column="pos_order_IsSend" property="posOrderIssend" jdbcType="CHAR" />
    <result column="pos_order_status" property="posOrderStatus" jdbcType="CHAR" />
    <result column="pos_order_sender" property="posOrderSender" jdbcType="VARCHAR" />
    <result column="cust_no" property="custNo" jdbcType="VARCHAR" />
    <result column="tour_grp" property="tourGrp" jdbcType="VARCHAR" />
    <result column="tour_no" property="tourNo" jdbcType="VARCHAR" />
    <result column="guide_no" property="guideNo" jdbcType="VARCHAR" />
    <result column="cust_sex" property="custSex" jdbcType="VARCHAR" />
    <result column="cust_id" property="custId" jdbcType="VARCHAR" />
    <result column="cust_age" property="custAge" jdbcType="VARCHAR" />
    <result column="cf_from" property="cfFrom" jdbcType="VARCHAR" />
    <result column="cf_ys" property="cfYs" jdbcType="VARCHAR" />
    <result column="cf_pyr" property="cfPyr" jdbcType="VARCHAR" />
    <result column="cf_fyr" property="cfFyr" jdbcType="VARCHAR" />
    <result column="cf_zd" property="cfZd" jdbcType="VARCHAR" />
    <result column="cf_no" property="cfNo" jdbcType="VARCHAR" />
  </resultMap>
  <insert id="insert" parameterType="com.gd.data.entity.TPosSaleMaster" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_pos_sale_master (sheet_no, oper_date, sale_time, 
      pos_type, pos_status, deal_no, 
      deal_class, user_id, branch_no, 
      counter_no, jh, local_no, 
      work_no, voucher_no, vip_no, 
      pos_org_amt, pos_total_amt, pos_integral, 
      cust_name, cust_man, cust_address, 
      cust_tel, cust_request, pos_order_time, 
      pos_send_time, deal_order, pos_memo, 
      pos_bytxt1, pos_bytxt2, pos_bytxt3, 
      update_flow, update_time, update_branch, 
      trans_upflag, fu_times, pos_order_IsSend, 
      pos_order_status, pos_order_sender, cust_no, 
      tour_grp, tour_no, guide_no, 
      cust_sex, cust_id, cust_age, 
      cf_from, cf_ys, cf_pyr, 
      cf_fyr, cf_zd, cf_no)
    values (#{sheetNo,jdbcType=VARCHAR}, #{operDate,jdbcType=TIMESTAMP}, #{saleTime,jdbcType=TIMESTAMP}, 
      #{posType,jdbcType=CHAR}, #{posStatus,jdbcType=CHAR}, #{dealNo,jdbcType=VARCHAR}, 
      #{dealClass,jdbcType=CHAR}, #{userId,jdbcType=VARCHAR}, #{branchNo,jdbcType=VARCHAR}, 
      #{counterNo,jdbcType=VARCHAR}, #{jh,jdbcType=VARCHAR}, #{localNo,jdbcType=VARCHAR}, 
      #{workNo,jdbcType=VARCHAR}, #{voucherNo,jdbcType=VARCHAR}, #{vipNo,jdbcType=VARCHAR}, 
      #{posOrgAmt,jdbcType=DECIMAL}, #{posTotalAmt,jdbcType=DECIMAL}, #{posIntegral,jdbcType=DECIMAL}, 
      #{custName,jdbcType=VARCHAR}, #{custMan,jdbcType=VARCHAR}, #{custAddress,jdbcType=VARCHAR}, 
      #{custTel,jdbcType=VARCHAR}, #{custRequest,jdbcType=VARCHAR}, #{posOrderTime,jdbcType=TIMESTAMP}, 
      #{posSendTime,jdbcType=TIMESTAMP}, #{dealOrder,jdbcType=VARCHAR}, #{posMemo,jdbcType=VARCHAR}, 
      #{posBytxt1,jdbcType=VARCHAR}, #{posBytxt2,jdbcType=VARCHAR}, #{posBytxt3,jdbcType=VARCHAR}, 
      #{updateFlow,jdbcType=DECIMAL}, #{updateTime,jdbcType=TIMESTAMP}, #{updateBranch,jdbcType=VARCHAR}, 
      #{transUpflag,jdbcType=VARCHAR}, #{fuTimes,jdbcType=INTEGER}, #{posOrderIssend,jdbcType=CHAR}, 
      #{posOrderStatus,jdbcType=CHAR}, #{posOrderSender,jdbcType=VARCHAR}, #{custNo,jdbcType=VARCHAR}, 
      #{tourGrp,jdbcType=VARCHAR}, #{tourNo,jdbcType=VARCHAR}, #{guideNo,jdbcType=VARCHAR}, 
      #{custSex,jdbcType=VARCHAR}, #{custId,jdbcType=VARCHAR}, #{custAge,jdbcType=VARCHAR}, 
      #{cfFrom,jdbcType=VARCHAR}, #{cfYs,jdbcType=VARCHAR}, #{cfPyr,jdbcType=VARCHAR}, 
      #{cfFyr,jdbcType=VARCHAR}, #{cfZd,jdbcType=VARCHAR}, #{cfNo,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.gd.data.entity.TPosSaleMaster" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_pos_sale_master
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="sheetNo != null" >
        sheet_no,
      </if>
      <if test="operDate != null" >
        oper_date,
      </if>
      <if test="saleTime != null" >
        sale_time,
      </if>
      <if test="posType != null" >
        pos_type,
      </if>
      <if test="posStatus != null" >
        pos_status,
      </if>
      <if test="dealNo != null" >
        deal_no,
      </if>
      <if test="dealClass != null" >
        deal_class,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="branchNo != null" >
        branch_no,
      </if>
      <if test="counterNo != null" >
        counter_no,
      </if>
      <if test="jh != null" >
        jh,
      </if>
      <if test="localNo != null" >
        local_no,
      </if>
      <if test="workNo != null" >
        work_no,
      </if>
      <if test="voucherNo != null" >
        voucher_no,
      </if>
      <if test="vipNo != null" >
        vip_no,
      </if>
      <if test="posOrgAmt != null" >
        pos_org_amt,
      </if>
      <if test="posTotalAmt != null" >
        pos_total_amt,
      </if>
      <if test="posIntegral != null" >
        pos_integral,
      </if>
      <if test="custName != null" >
        cust_name,
      </if>
      <if test="custMan != null" >
        cust_man,
      </if>
      <if test="custAddress != null" >
        cust_address,
      </if>
      <if test="custTel != null" >
        cust_tel,
      </if>
      <if test="custRequest != null" >
        cust_request,
      </if>
      <if test="posOrderTime != null" >
        pos_order_time,
      </if>
      <if test="posSendTime != null" >
        pos_send_time,
      </if>
      <if test="dealOrder != null" >
        deal_order,
      </if>
      <if test="posMemo != null" >
        pos_memo,
      </if>
      <if test="posBytxt1 != null" >
        pos_bytxt1,
      </if>
      <if test="posBytxt2 != null" >
        pos_bytxt2,
      </if>
      <if test="posBytxt3 != null" >
        pos_bytxt3,
      </if>
      <if test="updateFlow != null" >
        update_flow,
      </if>
      <if test="updateTime != null" >
        update_time,
      </if>
      <if test="updateBranch != null" >
        update_branch,
      </if>
      <if test="transUpflag != null" >
        trans_upflag,
      </if>
      <if test="fuTimes != null" >
        fu_times,
      </if>
      <if test="posOrderIssend != null" >
        pos_order_IsSend,
      </if>
      <if test="posOrderStatus != null" >
        pos_order_status,
      </if>
      <if test="posOrderSender != null" >
        pos_order_sender,
      </if>
      <if test="custNo != null" >
        cust_no,
      </if>
      <if test="tourGrp != null" >
        tour_grp,
      </if>
      <if test="tourNo != null" >
        tour_no,
      </if>
      <if test="guideNo != null" >
        guide_no,
      </if>
      <if test="custSex != null" >
        cust_sex,
      </if>
      <if test="custId != null" >
        cust_id,
      </if>
      <if test="custAge != null" >
        cust_age,
      </if>
      <if test="cfFrom != null" >
        cf_from,
      </if>
      <if test="cfYs != null" >
        cf_ys,
      </if>
      <if test="cfPyr != null" >
        cf_pyr,
      </if>
      <if test="cfFyr != null" >
        cf_fyr,
      </if>
      <if test="cfZd != null" >
        cf_zd,
      </if>
      <if test="cfNo != null" >
        cf_no,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="sheetNo != null" >
        #{sheetNo,jdbcType=VARCHAR},
      </if>
      <if test="operDate != null" >
        #{operDate,jdbcType=TIMESTAMP},
      </if>
      <if test="saleTime != null" >
        #{saleTime,jdbcType=TIMESTAMP},
      </if>
      <if test="posType != null" >
        #{posType,jdbcType=CHAR},
      </if>
      <if test="posStatus != null" >
        #{posStatus,jdbcType=CHAR},
      </if>
      <if test="dealNo != null" >
        #{dealNo,jdbcType=VARCHAR},
      </if>
      <if test="dealClass != null" >
        #{dealClass,jdbcType=CHAR},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=VARCHAR},
      </if>
      <if test="branchNo != null" >
        #{branchNo,jdbcType=VARCHAR},
      </if>
      <if test="counterNo != null" >
        #{counterNo,jdbcType=VARCHAR},
      </if>
      <if test="jh != null" >
        #{jh,jdbcType=VARCHAR},
      </if>
      <if test="localNo != null" >
        #{localNo,jdbcType=VARCHAR},
      </if>
      <if test="workNo != null" >
        #{workNo,jdbcType=VARCHAR},
      </if>
      <if test="voucherNo != null" >
        #{voucherNo,jdbcType=VARCHAR},
      </if>
      <if test="vipNo != null" >
        #{vipNo,jdbcType=VARCHAR},
      </if>
      <if test="posOrgAmt != null" >
        #{posOrgAmt,jdbcType=DECIMAL},
      </if>
      <if test="posTotalAmt != null" >
        #{posTotalAmt,jdbcType=DECIMAL},
      </if>
      <if test="posIntegral != null" >
        #{posIntegral,jdbcType=DECIMAL},
      </if>
      <if test="custName != null" >
        #{custName,jdbcType=VARCHAR},
      </if>
      <if test="custMan != null" >
        #{custMan,jdbcType=VARCHAR},
      </if>
      <if test="custAddress != null" >
        #{custAddress,jdbcType=VARCHAR},
      </if>
      <if test="custTel != null" >
        #{custTel,jdbcType=VARCHAR},
      </if>
      <if test="custRequest != null" >
        #{custRequest,jdbcType=VARCHAR},
      </if>
      <if test="posOrderTime != null" >
        #{posOrderTime,jdbcType=TIMESTAMP},
      </if>
      <if test="posSendTime != null" >
        #{posSendTime,jdbcType=TIMESTAMP},
      </if>
      <if test="dealOrder != null" >
        #{dealOrder,jdbcType=VARCHAR},
      </if>
      <if test="posMemo != null" >
        #{posMemo,jdbcType=VARCHAR},
      </if>
      <if test="posBytxt1 != null" >
        #{posBytxt1,jdbcType=VARCHAR},
      </if>
      <if test="posBytxt2 != null" >
        #{posBytxt2,jdbcType=VARCHAR},
      </if>
      <if test="posBytxt3 != null" >
        #{posBytxt3,jdbcType=VARCHAR},
      </if>
      <if test="updateFlow != null" >
        #{updateFlow,jdbcType=DECIMAL},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBranch != null" >
        #{updateBranch,jdbcType=VARCHAR},
      </if>
      <if test="transUpflag != null" >
        #{transUpflag,jdbcType=VARCHAR},
      </if>
      <if test="fuTimes != null" >
        #{fuTimes,jdbcType=INTEGER},
      </if>
      <if test="posOrderIssend != null" >
        #{posOrderIssend,jdbcType=CHAR},
      </if>
      <if test="posOrderStatus != null" >
        #{posOrderStatus,jdbcType=CHAR},
      </if>
      <if test="posOrderSender != null" >
        #{posOrderSender,jdbcType=VARCHAR},
      </if>
      <if test="custNo != null" >
        #{custNo,jdbcType=VARCHAR},
      </if>
      <if test="tourGrp != null" >
        #{tourGrp,jdbcType=VARCHAR},
      </if>
      <if test="tourNo != null" >
        #{tourNo,jdbcType=VARCHAR},
      </if>
      <if test="guideNo != null" >
        #{guideNo,jdbcType=VARCHAR},
      </if>
      <if test="custSex != null" >
        #{custSex,jdbcType=VARCHAR},
      </if>
      <if test="custId != null" >
        #{custId,jdbcType=VARCHAR},
      </if>
      <if test="custAge != null" >
        #{custAge,jdbcType=VARCHAR},
      </if>
      <if test="cfFrom != null" >
        #{cfFrom,jdbcType=VARCHAR},
      </if>
      <if test="cfYs != null" >
        #{cfYs,jdbcType=VARCHAR},
      </if>
      <if test="cfPyr != null" >
        #{cfPyr,jdbcType=VARCHAR},
      </if>
      <if test="cfFyr != null" >
        #{cfFyr,jdbcType=VARCHAR},
      </if>
      <if test="cfZd != null" >
        #{cfZd,jdbcType=VARCHAR},
      </if>
      <if test="cfNo != null" >
        #{cfNo,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>

  <select id="selectSaleDetail" resultType="com.gd.data.entity.TPosSale">
    SELECT CONCAT(REPLACE(a.sheet_no,"-",""), a.sheet_sort) as id, b.sale_time as saleTime, a.sale_amt as saleAmt, a.sale_qty as saleQty,  a.sheet_no as sheetNo, a.sale_barcode as saleBarcode, a.sale_man as saleMan,  b.jh as jh, b.user_id as userId, b.branch_no as branchNo from  t_pos_sale_detail a  LEFT JOIN t_pos_sale_master b on b.sheet_no = a.sheet_no
    <if test="date != null">
      where sale_time > #{date,jdbcType=TIMESTAMP}
    </if>
    order by b.sale_time asc limit 100
  </select>

  <select id="selectOrderDetail" resultType="com.gd.data.entity.TOrderDetail">
  SELECT REPLACE(a.sheet_no,"-","") as id, a.pos_total_amt as posTotalAmt, b.payment_no as paymentNo, a.sale_time as saleTime , c.vip_dispno as dispNo, a.vip_no as vipNo, a.branch_no as branchNo
  from  t_pos_sale_master a LEFT JOIN t_pos_sale_payment b on a.sheet_no = b.sheet_no and b.sheet_sort=1  LEFT JOIN t_vip_info c on
  a.vip_no = c.vip_no
  <if test="date != null">
      where sale_time > #{date,jdbcType=TIMESTAMP}
  </if>
  order by a.sale_time asc limit 100
 </select>
</mapper>